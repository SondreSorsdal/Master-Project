---
title: "Aphid shoot"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(stringr)
library(readxl)
library(readr)
library(lubridate)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:


```{r}
##Aphid infected shoots##

#Loading dataset for aphid infected shoots 
aphid_infected_shoot <- read_excel("data/Aphid_shoot_trial1.xlsx")


#Dataframe for frass spray application experiment
spray_frass.df <- aphid_infected_shoot %>% 
  filter(experiment %in% c('felles', '2a'))

#Dataframe for frass in soil experiment
frass_soil.df <- aphid_infected_shoot %>% 
  filter(experiment %in% c('felles', '2b'))
```



```{r}

#Making dataframe of each date measured. Filtering out treatment 3 since this is the control for experiment 2b.

aphid_shoot_spray1.df <- spray_frass.df %>%
  filter(!behandling == 3) %>% 
    select(Trenummer,behandling,`Aphid_16/06`) %>% 
    group_by(behandling)

aphid_shoot_spray2.df <- spray_frass.df %>%
  filter(!behandling == 3) %>% 
    select(Trenummer,behandling, `Aphid_ 23/06`) %>% 
    group_by(behandling)

aphid_shoot_spray3.df <- spray_frass.df %>%
  filter(!behandling == 3) %>% 
    select(Trenummer,behandling, `Aphid_30/06`) %>% 
    group_by(behandling)

aphid_shoot_spray4.df <- spray_frass.df %>%
  filter(!behandling == 3) %>% 
    select(Trenummer,behandling, `Aphid_07/07`) %>% 
    group_by(behandling)
```

```{r}
#Making dataframe of each date measured. Filtering out treatment 2 since this is the control for experiment 2a.

frass_soil_shoot1.df <- frass_soil.df %>%
  filter(!behandling == 2) %>% 
    select(Trenummer,behandling,`Aphid_16/06`) %>% 
    group_by(behandling)

frass_soil_shoot2.df <- frass_soil.df %>%
  filter(!behandling == 2) %>% 
    select(Trenummer,behandling, `Aphid_ 23/06`) %>% 
    group_by(behandling)

frass_soil_shoot3.df <- frass_soil.df %>%
  filter(!behandling == 2) %>% 
    select(Trenummer,behandling, `Aphid_30/06`) %>% 
    group_by(behandling)

frass_soil_shoot4.df <- frass_soil.df %>%
  filter(!behandling == 2) %>% 
    select(Trenummer,behandling, `Aphid_07/07`) %>% 
    group_by(behandling)
```



```{r echo = FALSE}

#Making simple boxplots for visualisation for spray application experiment

 ggplot(aphid_shoot_spray1.df) +
  aes(x = behandling, y = `Aphid_16/06`) +
  geom_boxplot() +
  scale_color_hue(direction = 1) +
  labs(
    x = "Treatment",
    y = "Aphid shoots",
    title = "Aphid shoot 16/06"
  ) +
   theme_minimal()

 ggplot(aphid_shoot_spray2.df) +
  aes(x = behandling, y = `Aphid_ 23/06`
      ) +
  geom_boxplot() +
  scale_color_hue(direction = 1) +
  labs(
    x = "Treatment",
    y = "Aphid shoots",
    title = "Aphid shoot 23/06"
  ) +
  theme_minimal()


 ggplot(aphid_shoot_spray3.df) +
  aes(x = behandling, y = `Aphid_30/06`
      ) +
  geom_boxplot() +
  scale_color_hue(direction = 1) +
  labs(
    x = "Treatment",
    y = "Aphid shoots",
    title = "Aphid shoot 30/06"
  ) +
  theme_minimal()

 ggplot(aphid_shoot_spray4.df) +
  aes(x = behandling, y = `Aphid_07/07`
      ) +
  geom_boxplot() +
  scale_color_hue(direction = 1) +
  labs(
    x = "Treatment",
    y = "Aphid shoots",
    title = "Aphid shoot 07/07"
  ) +
  theme_minimal()



```


```{r}
#Making simple boxplots for visualisation for frass in soil experiment

 ggplot(frass_soil_shoot1.df) +
  aes(x = behandling, y = `Aphid_16/06`) +
  geom_boxplot() +
  scale_color_hue(direction = 1) +
  labs(
    x = "Treatment",
    y = "Aphid shoots",
    title = "Aphid shoot 16/06"
  ) +
   theme_minimal()

 ggplot(frass_soil_shoot2.df) +
  aes(x = behandling, y = `Aphid_ 23/06`
      ) +
  geom_boxplot() +
  scale_color_hue(direction = 1) +
  labs(
    x = "Treatment",
    y = "Aphid shoots",
    title = "Aphid shoot 23/06"
  ) +
  theme_minimal()


 ggplot(frass_soil_shoot3.df) +
  aes(x = behandling, y = `Aphid_30/06`
      ) +
  geom_boxplot() +
  scale_color_hue(direction = 1) +
  labs(
    x = "Treatment",
    y = "Aphid shoots",
    title = "Aphid shoot 30/06"
  ) +
  theme_minimal()

 ggplot(frass_soil_shoot4.df) +
  aes(x = behandling, y = `Aphid_07/07`
      ) +
  geom_boxplot() +
  scale_color_hue(direction = 1) +
  labs(
    x = "Treatment",
    y = "Aphid shoots",
    title = "Aphid shoot 07/07"
  ) +
  theme_minimal()


```

##Aphid shoot length##

```{r}
##Aphid shoot length##

#Loading dataset for aphid shoot length
aphid_shoot_length <- read_excel("data/Shoot_length.xlsx")


#Dataframe for shoot length in frass spray application experiment
shoot_length_spray.df <- aphid_shoot_length %>% 
  filter(experiment %in% c('felles', '2a'))

#Dataframe for shoot length in frass in soil experiment
frass_length_soil.df <- aphid_shoot_length %>% 
  filter(experiment %in% c('felles', '2b'))


```

```{r}

#Making dataframe of each date measured. Filtering out treatment 3 since this is the control for experiment 2b.

frass_spray_shoot_length1.df <- shoot_length_spray.df %>%
  filter(!behandling == 3) %>% 
    select(behandling,`Shoot_length_01-04/6`) %>% 
    group_by(behandling)

frass_spray_shoot_length2.df <- shoot_length_spray.df %>%
  filter(!behandling == 3) %>% 
    select(behandling,`Shoot_length_18/6`) %>% 
    group_by(behandling)

frass_spray_shoot_length3.df <- shoot_length_spray.df %>%
  filter(!behandling == 3) %>% 
    select(behandling,`Shoot_length_09/7`) %>% 
    group_by(behandling)


```

```{r}
#Making simple boxplots for visualisation for shoot length in spray application

 ggplot(frass_spray_shoot_length1.df) +
  aes(x = behandling, y = `Shoot_length_01-04/6`) +
  geom_boxplot() +
  scale_color_hue(direction = 1) +
  labs(
    x = "Treatment",
    y = "Shoot length",
    title = "Aphid shoot 01/06 - Frass spray application"
  ) +
   theme_minimal()

 ggplot(frass_spray_shoot_length2.df) +
  aes(x = behandling, y = `Shoot_length_18/6`) +
  geom_boxplot() +
  scale_color_hue(direction = 1) +
  labs(
    x = "Treatment",
    y = "Shoot length",
    title = "Aphid shoot 18/06 - Frass spray application"
  ) +
   theme_minimal()
 
  ggplot(frass_spray_shoot_length3.df) +
  aes(x = behandling, y = `Shoot_length_09/7`) +
  geom_boxplot() +
  scale_color_hue(direction = 1) +
  labs(
    x = "Treatment",
    y = "Shoot length",
    title = "Aphid shoot 09/07 - Frass spray application"
  ) +
   theme_minimal()
```



```{r}

#Making dataframe of each date measured. Filtering out treatment 2 since this is the control for experiment 2a.

frass_soil_shoot_length1.df <- frass_length_soil.df %>%
  filter(!behandling == 2) %>% 
    select(behandling,`Shoot_length_01-04/6`) %>% 
    group_by(behandling)

frass_soil_shoot_length2.df <- frass_length_soil.df %>%
  filter(!behandling == 2) %>% 
    select(behandling,`Shoot_length_18/6`) %>% 
    group_by(behandling)

frass_soil_shoot_length3.df <- frass_length_soil.df %>%
  filter(!behandling == 2) %>% 
    select(behandling,`Shoot_length_09/7`) %>% 
    group_by(behandling)
```


```{r}
#Making simple boxplots for visualisation for shoot length in frass in soil

 ggplot(frass_soil_shoot_length1.df) +
  aes(x = behandling, y = `Shoot_length_01-04/6`) +
  geom_boxplot() +
  scale_color_hue(direction = 1) +
  labs(
    x = "Treatment",
    y = "Shoot length",
    title = "Aphid shoot length 01/06 - Frass in soil"
  ) +
   theme_minimal()

 ggplot(frass_soil_shoot_length2.df) +
  aes(x = behandling, y = `Shoot_length_18/6`) +
  geom_boxplot() +
  scale_color_hue(direction = 1) +
  labs(
    x = "Treatment",
    y = "Shoot length",
    title = "Aphid shoot length 18/06 - Frass in soil"
  ) +
   theme_minimal()
 
  ggplot(frass_soil_shoot_length3.df) +
  aes(x = behandling, y = `Shoot_length_09/7`) +
  geom_boxplot() +
  scale_color_hue(direction = 1) +
  labs(
    x = "Treatment",
    y = "Shoot length",
    title = "Aphid shoot length 09/07 - Frass in soil"
  ) +
   theme_minimal()
```

